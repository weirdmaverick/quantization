import numpy as np
FP8_E3M4 = [
    -31.0, -30.0, -29.0, -28.0, -27.0, -26.0, -25.0, -24.0, -23.0, -22.0, -21.0, -20.0, -19.0, -18.0, -17.0, -16.0, -15.5, -15.0, -14.5, -14.0, -13.5,
    -13.0, -12.5, -12.0, -11.5, -11.0, -10.5, -10.0, -9.5, -9.0, -8.5, -8.0, 7.75, -7.5, -7.25, -7.0, -6.75, -6.5, -6.25, -6.0, -5.75, -5.5, -5.25,
    -5.0, -4.75, -4.5, -4.25, -4.0, -3.875, -3.75, -3.625, -3.5, -3.375, -3.25, -3.125, -3.0, -2.875, -2.75, -2.625, -2.5, -2.375, -2.25, -2.125, -2.0,
    -1.9375, -1.875, -1.8125, -1.75, -1.6875, -1.625, -1.5625, -1.5, -1.4375, -1.375, -1.3125, -1.25, -1.1875, -1.125, -1.0625, -1.0, -0.96875, -0.9375,
    -0.90625, -0.875, -0.84375, -0.8125, -0.78125, -0.75, -0.71875, -0.6875, -0.65625, -0.625, -0.59375, -0.5625, -0.53125, -0.5, -0.484375, -0.46875,
    -0.453125, -0.4375, -0.421875, -0.40625, -0.390625, -0.375, -0.359375, -0.34375, -0.328125, -0.3125, -0.296875, -0.28125, -0.265625, -0.25, -0.2421875,
    -0.234375, -0.2265625, -0.21875, -0.2109375, -0.203125, -0.1953125, -0.1875, -0.1796875, -0.171875, -0.1640625, -0.15625, -0.1484375, -0.140625,
    -0.1328125, 0.0,
    0.1328125, 0.140625, 0.1484375, 0.15625, 0.1640625, 0.171875, 0.1796875, 0.1875, 0.1953125, 0.203125, 0.2109375, 0.21875, 0.2265625,0.234375, 0.2421875,
    0.25, 0.265625, 0.28125, 0.296875, 0.3125, 0.328125, 0.34375, 0.359375, 0.375, 0.390625, 0.40625, 0.421875, 0.4375, 0.453125, 0.46875, 0.484375, 0.5,
    0.53125, 0.5625, 0.59375, 0.625, 0.65625, 0.6875, 0.71875, 0.75, 0.78125, 0.8125, 0.84375, 0.875, 0.90625, 0.9375, 0.96875,1.0, 1.0625, 1.125, 1.1875,
    1.25, 1.3125, 1.375, 1.4375, 1.5, 1.5625, 1.625, 1.6875, 1.75, 1.8125, 1.875, 1.9375, 2.0, 2.125, 2.25, 2.375, 2.5, 2.625, 2.75, 2.875, 3.0, 3.125, 3.25,
    3.375, 3.5, 3.625, 3.75, 3.875, 4.0, 4.25, 4.5, 4.75, 5.0, 5.25, 5.5, 5.75, 6.0, 6.25, 6.5, 6.75, 7.0, 7.25, 7.5, 7.75, 8.0, 8.5, 9.0, 9.5, 10.0, 10.5, 11.0,
    11.5, 12.0, 12.5, 13.0, 13.5, 14.0, 14.5, 15.0, 15.5, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0
    ]
SCALE_FP8_E3M4 = 0.24938965/31 
FP8_E3M4 = np.array(FP8_E3M4)
Dequant_FP8_E3M4 = FP8_E3M4 * SCALE_FP8_E3M4
print("Dequant_FP8_E3M4")
print(Dequant_FP8_E3M4)
print()
# resolution 변화 추적
resolutions = np.diff(Dequant_FP8_E3M4)
resolution_ranges = []

current_res = None
range_start = None

for i, res in enumerate(resolutions):
    res_abs = round(abs(res), 10)
    if current_res is None:
        current_res = res_abs
        range_start = i
    elif res_abs != current_res:
        resolution_ranges.append((current_res, Dequant_FP8_E3M4[range_start], Dequant_FP8_E3M4[i]))
        current_res = res_abs
        range_start = i

resolution_ranges.append((current_res, Dequant_FP8_E3M4[range_start], Dequant_FP8_E3M4[-1]))
resolution_ranges[:15]
print(resolution_ranges)
print()

FP8_E4M3 = [
    -480.0, -448.0, -416.0, -384.0, -352.0, -320.0, -288.0, -256.0, -240.0, -224.0, -208.0, -192.0, -176.0, -160.0, -144.0, -128.0, -120.0, -112.0,
    -104.0, -96.0, -88.0, -80.0, -72.0, -64.0, -60.0, -56.0, -52.0, -48.0, -44.0, -40.0, -36.0, -32.0, -30.0, -28.0, -26.0, -24.0, -22.0, -20.0, -18.0,
    -16.0, -15.0, -14.0, -13.0, -12.0, -11.0, -10.0, -9.0, -8.0, -7.5, -7.0, -6.5, -6.0, -5.5, -5.0, -4.5, -4.0, -3.75, -3.5, -3.25, -3.0, -2.75, -2.5,
    -2.25, -2.0, -1.875, -1.75, -1.625, -1.5, -1.375, -1.25, -1.125, -1.0, -0.9375, -0.875, -0.8125, -0.75, -0.6875, -0.625, -0.5625, -0.5, -0.46875,
    -0.4375, -0.40625, -0.375, -0.34375, -0.3125, -0.28125, -0.25, -0.234375, -0.21875, -0.203125, -0.1875, -0.171875, -0.15625, -0.140625, -0.125,
    -0.1171875, -0.109375, -0.1015625, -0.09375, -0.0859375, -0.078125, -0.0703125, -0.0625, -0.05859375, -0.0546875, -0.05078125, -0.046875, -0.04296875,
    -0.0390625, -0.03515625, -0.03125, -0.029296875, -0.02734375, -0.025390625, -0.0234375, -0.021484375, -0.01953125, -0.017578125, -0.015625, -0.0146484375,
    -0.013671875, -0.0126953125, -0.01171875, -0.0107421875, -0.009765625, -0.0087890625, 0.0,
    0.0087890625, 0.009765625, 0.0107421875, 0.01171875, 0.0126953125, 0.013671875, 0.0146484375, 0.015625, 0.017578125, 0.01953125, 0.021484375, 0.0234375,
    0.025390625, 0.02734375, 0.029296875, 0.03125, 0.03515625, 0.0390625, 0.04296875, 0.046875, 0.05078125, 0.0546875, 0.05859375, 0.0625, 0.0703125, 0.078125,
    0.0859375, 0.09375, 0.1015625, 0.109375, 0.1171875, 0.125, 0.140625, 0.15625, 0.171875, 0.1875, 0.203125, 0.21875, 0.234375, 0.25, 0.28125, 0.3125, 0.34375,
    0.375, 0.40625, 0.4375, 0.46875, 0.5, 0.5625, 0.625, 0.6875, 0.75, 0.8125, 0.875, 0.9375, 1.0, 1.125, 1.25, 1.375, 1.5, 1.625, 1.75, 1.875, 2.0, 2.25, 2.5,
    2.75, 3.0, 3.25, 3.5, 3.75, 4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 18.0, 20.0, 22.0, 24.0, 26.0, 28.0,
    30.0, 32.0, 36.0, 40.0, 44.0, 48.0, 52.0, 56.0, 60.0, 64.0, 72.0, 80.0, 88.0, 96.0, 104.0, 112.0, 120.0, 128.0, 144.0, 160.0, 176.0, 192.0, 208.0, 224.0,
    240.0, 256.0, 288.0, 320.0, 352.0, 384.0, 416.0, 448.0, 480.0
    ]

SCALE_FP8_E4M3 = 0.24938965/480 
FP8_E4M3 = np.array(FP8_E4M3)
Dequant_FP8_E4M3 = FP8_E4M3 * SCALE_FP8_E4M3
print("Dequant_FP8_E4M3")
print(Dequant_FP8_E4M3)

INT8=list(range(-127,128)) # -127,-126,-125, ..., 0, 1, 2, ..., 126, 127
SCALE_INT8 = 0.24938965/127
INT8 = np.array(INT8)
Dequant_INT8 = INT8 * SCALE_INT8
print("Dequant_INT8")
print(Dequant_INT8)